# Отчёт по реализованному функционалу

## 1. Система аутентификации

Реализована модульная система аутентификации на основе паттерна «провайдер». В файле `scripts/auth.js` описаны два взаимозаменяемых провайдера:

- **Mock-провайдер** — работает полностью на стороне клиента: хранит пользователей в `localStorage`, используется на этапе разработки без необходимости запуска сервера.
- **API-провайдер** — взаимодействует с backend-сервером через HTTP-запросы (`fetch`). Поддерживает методы входа, регистрации, обновления профиля, активации Premium-подписки и выхода из аккаунта. При успешной аутентификации сохраняет JWT-токен и данные сессии в `localStorage`.

Активный провайдер назначается через `window.authProvider`, что позволяет переключать реализацию без изменения остального кода.

---

## 2. Premium-подписка

Реализован полный цикл работы с Premium-статусом пользователя:

- На странице аккаунта отображается кнопка с иконкой, визуально отражающей текущий статус подписки (активна / не активна).
- При активации Premium отправляется запрос к серверу, который устанавливает срок действия подписки на 1 месяц от момента активации.
- Имя пользователя с активной подпиской отображается с анимированным градиентным эффектом.
- Модальное окно Premium информирует о составе подписки, отображает дату окончания при активном статусе и позволяет продлить подписку.

---

## 3. Backend REST API

Разработан серверный модуль на базе **Node.js** и фреймворка **Express.js** с подключением к базе данных **PostgreSQL**.

Реализованы следующие маршруты:

| Метод  | Маршрут              | Описание                                 |
|--------|----------------------|------------------------------------------|
| POST   | `/api/auth/register` | Регистрация нового пользователя          |
| POST   | `/api/auth/login`    | Вход в аккаунт                           |
| PATCH  | `/api/auth/profile`  | Обновление данных профиля                |
| GET    | `/api/auth/me`       | Получение данных текущего пользователя   |
| POST   | `/api/auth/premium`  | Активация Premium-подписки на 1 месяц   |

Пароли хранятся в хешированном виде с использованием библиотеки **bcrypt** (10 раундов соли). Аутентификация на защищённых маршрутах осуществляется через **JWT-токены** со сроком действия 7 дней.

---

## 4. JWT Middleware

Для защиты серверных маршрутов реализован промежуточный слой (`server/middleware/auth.js`), который:

- Извлекает JWT-токен из HTTP-заголовка `Authorization: Bearer <token>`.
- Проверяет подпись и срок действия токена.
- При успешной проверке передаёт декодированные данные пользователя в объект `req.user` для использования в обработчиках маршрутов.
- При отсутствии или недействительности токена возвращает ответ с кодом `401 Unauthorized`.
